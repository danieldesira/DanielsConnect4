{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack:///./src/lib/enums/dot.ts","webpack:///./src/lib/enums/game-mode.ts","webpack:///./src/lib/enums/sound.ts","webpack:///./src/lib/game.ts","webpack:///./src/lib/position.ts","webpack:///./src/lib/socket.ts","webpack:///./src/lib/utils.ts","webpack:///webpack/bootstrap","webpack:///./src/main.ts"],"sourcesContent":["export enum Dot {\r\n    Empty = 'black',\r\n    Red = 'red',\r\n    Green = 'greenyellow'\r\n}","export enum GameMode {\r\n    SamePC = 1,\r\n    Network = 2\r\n}","export enum Sound {\r\n    LandDot = './sounds/land-dot.m4a',\r\n    Win = './sounds/win.m4a',\r\n    Lose = './sounds/lose.m4a'\r\n}","import { GameMode } from './enums/game-mode';\r\nimport { Dot } from './enums/dot';\r\nimport { Position } from './position';\r\nimport { Utils } from './utils';\r\nimport { Socket } from './socket';\r\nimport { Sound } from './enums/sound';\r\n\r\nexport class Game {\r\n\r\n    private static instance: Game;\r\n\r\n    private static columns: number = 9;\r\n    private static rows: number = 8;\r\n\r\n    private canvas: any;\r\n    private context: any;\r\n    private board: Array<Array<Dot>> = new Array(Game.columns);\r\n\r\n    private exitBtn: any;\r\n    private timerSpan: any;\r\n    private playerRedSpan: any;\r\n    private playerGreenSpan: any;\r\n\r\n    private turn: Dot = Dot.Red;\r\n\r\n    private playerRed: string;\r\n    private playerGreen: string;\r\n\r\n    public mode: GameMode;\r\n    public onGameEnd: Function;\r\n\r\n    private secondsRunning: number;\r\n    private timeout: any;\r\n\r\n    private circleRadius: number;\r\n    private rowGap: number;\r\n    private colGap: number;\r\n\r\n    private socket: Socket;\r\n\r\n    private constructor(canvasId: string,\r\n                exitBtnId: string,\r\n                timerId: string,\r\n                playerRedId: string,\r\n                playerGreenId: string) {\r\n        this.canvas = document.getElementById(canvasId);\r\n        this.context = this.canvas.getContext('2d');\r\n\r\n        this.initBoard();\r\n\r\n        if (exitBtnId !== null) {\r\n            this.exitBtn = document.getElementById(exitBtnId);\r\n        }\r\n\r\n        if (timerId !== null) {\r\n            this.timerSpan = document.getElementById(timerId);\r\n            this.secondsRunning = 0;\r\n        }\r\n\r\n        if (playerRedId !== null) {\r\n            this.playerRedSpan = document.getElementById(playerRedId);\r\n        }\r\n\r\n        if (playerGreenId !== null) {\r\n            this.playerGreenSpan = document.getElementById(playerGreenId);\r\n        }\r\n    }\r\n\r\n    public static getInstance(canvasId: string,\r\n                exitBtnId: string = null,\r\n                timerId: string = null,\r\n                playerRedId: string = null,\r\n                playerGreenId: string = null): Game {\r\n        if (!Game.instance) {\r\n            Game.instance = new Game(canvasId, exitBtnId, timerId, playerRedId, playerGreenId);\r\n        }\r\n        return Game.instance;\r\n    }\r\n\r\n    private initBoard() {\r\n        for (let col = 0; col < Game.columns; col++) {\r\n            this.board[col] = new Array(Game.rows);\r\n            for (let row = 0; row < Game.rows; row++){\r\n                this.board[col][row] = Dot.Empty;\r\n            }\r\n        }\r\n    }\r\n\r\n    public start() {\r\n        if (this.mode === GameMode.SamePC) {\r\n            this.checkGameData();\r\n            this.setUpPlayerNames();\r\n        } else if (this.mode === GameMode.Network) {\r\n            this.defineSocket();\r\n        }\r\n        \r\n        this.printPlayerNames();\r\n        this.resizeCanvas();\r\n        this.setGameEvents();\r\n        this.setTimer();\r\n    }\r\n\r\n    private checkGameData() {\r\n        let board = localStorage.getItem('board');\r\n        let nextTurn = localStorage.getItem('nextTurn');\r\n        \r\n        if (board && nextTurn) {\r\n            let restore = confirm('Do you want to continue playing the previous game? OK/Cancel');\r\n            if (restore) {\r\n                this.restoreLastGame();\r\n            } else {\r\n                localStorage.clear();\r\n            }\r\n        }\r\n    }\r\n\r\n    private setUpPlayerNames() {\r\n        if (!localStorage.getItem('playerRed') || !localStorage.getItem('playerGreen')) {\r\n            this.playerRed = prompt('Please enter name for Red Player!');\r\n            this.playerGreen = prompt('Please enter name for Green Player!');\r\n        }\r\n    }\r\n\r\n    private printPlayerNames() {\r\n        const waiting = 'Waiting to connect...';\r\n        if (this.playerGreenSpan) {\r\n            if (this.mode === GameMode.Network && !this.playerGreen) {\r\n                this.playerGreenSpan.innerText = waiting;\r\n            } else {\r\n                this.playerGreenSpan.innerText = this.playerGreen;\r\n            }\r\n        }\r\n        if (this.playerRedSpan) {\r\n            if (this.mode === GameMode.Network && !this.playerRed) {\r\n                this.playerRedSpan.innerText = waiting;\r\n            } else {\r\n                this.playerRedSpan.innerText = this.playerRed;\r\n            }\r\n        }\r\n    }\r\n\r\n    private paintBoard() {\r\n        let boardGradient = this.context.createLinearGradient(0, 0, this.canvas.width, 0);\r\n        boardGradient.addColorStop(0, 'blue');\r\n        boardGradient.addColorStop(1, 'aqua');\r\n        this.context.fillStyle = boardGradient;\r\n        this.context.fillRect(0, 70, this.canvas.width, this.canvas.height);\r\n\r\n        for (let col = Game.columns - 1; col >= 0; col--) {\r\n            for (let row = Game.rows - 1; row >= 0; row--) {\r\n                this.context.fillStyle = this.board[col][row];\r\n\r\n                this.context.beginPath();\r\n                this.context.arc(50 + col * this.colGap, 150 + row * this.rowGap, this.circleRadius, 0, 2 * Math.PI);\r\n                this.context.closePath();\r\n                this.context.fill();\r\n            }\r\n        }\r\n    }\r\n\r\n    private setGameEvents() {\r\n        this.canvas.addEventListener('mousemove', this.canvasMousemove, false);\r\n        this.canvas.addEventListener('click', this.canvasClick, false);\r\n        window.addEventListener('beforeunload', this.beforeUnload);\r\n        window.addEventListener('resize', this.resizeCanvas);\r\n        document.addEventListener('visibilitychange', this.pageVisibilityChange);\r\n    }\r\n\r\n    private canvasMousemove = (event) => {\r\n        if (this.mode === GameMode.SamePC || (this.socket && this.turn === this.socket.getPlayerColor() && this.opponentConnected())) {\r\n            let position: Position = Position.getCursorPosition(event, this.canvas);\r\n            let column = Math.round((position.x - 50) / this.colGap);\r\n            this.moveDot(column);\r\n\r\n            if (this.mode === GameMode.Network && this.socket) {\r\n                let data = {\r\n                    action: 'mousemove',\r\n                    column: column\r\n                };\r\n                this.socket.send(data);\r\n            }\r\n        }\r\n    };\r\n\r\n    private canvasClick = (event) => {\r\n        if (this.mode === GameMode.SamePC || (this.socket && this.turn === this.socket.getPlayerColor() && this.opponentConnected())) {\r\n            let position = Position.getCursorPosition(event, this.canvas);\r\n            let column = Math.round((position.x - 50) / this.colGap);\r\n            this.landDot(column);\r\n\r\n            if (this.mode === GameMode.Network && this.socket) {\r\n                let data = {\r\n                    action: 'click',\r\n                    column: column\r\n                };\r\n                this.socket.send(data);\r\n            }\r\n        }\r\n    };\r\n\r\n    private switchTurn() {\r\n        if (this.turn === Dot.Red) {\r\n            this.turn = Dot.Green;\r\n        } else if (this.turn === Dot.Green) {\r\n            this.turn = Dot.Red;\r\n        }\r\n    }\r\n\r\n    private moveDot(column: number) {\r\n        this.clearUpper();\r\n        this.context.fillStyle = this.turn;\r\n        this.paintDotToDrop(column);\r\n    }\r\n\r\n    private landDot(column: number) {\r\n        let row: number;\r\n\r\n        if (this.board[column][0] === Dot.Empty) {\r\n\r\n            // Places the circle at the buttom of the column\r\n            for (var r = Game.rows - 1; r > -1; r--) {\r\n                if (this.board[column][r] === Dot.Empty) {\r\n                    this.board[column][r] = this.turn;\r\n                    row = r;\r\n                    break;\r\n                }\r\n            }\r\n            \r\n            this.context.fillStyle = this.turn;\r\n            \r\n            // Draws the circle at the appropriate position\r\n            this.context.beginPath();\r\n            this.context.arc(50 + column * this.colGap, 150 + r * this.rowGap, this.circleRadius, 0, Math.PI * 2);\r\n            this.context.closePath();\r\n            this.context.fill();\r\n            \r\n            let dotCount = this.checkDotCount(column, row);\r\n\r\n            if (dotCount > 3) { // If a player completes 4 dots\r\n                let winner: string = '';\r\n                if (this.turn === Dot.Red) {\r\n                    winner = this.playerRed + ' (Red)';\r\n                } else if (this.turn === Dot.Green) {\r\n                    winner = this.playerGreen + ' (Green)';\r\n                }\r\n\r\n                this.winDialog(winner);\r\n                this.closeGameByWinning();\r\n            } else if (this.isBoardFull()) {\r\n                alert(this.playerRed + ' (Red) and ' + this.playerGreen + ' (Green) are tied!');\r\n                this.closeGameByWinning();\r\n            } else { // If game is still going on\r\n                this.switchTurn();\r\n                this.context.fillStyle = this.turn;\r\n                this.paintDotToDrop(column);\r\n                Utils.playSound(Sound.LandDot);\r\n            }\r\n        }\r\n    }\r\n\r\n    private winDialog(winner: string) {\r\n        let winMsg: string = winner + ' wins!';\r\n        if (this.timerSpan) {\r\n            winMsg += '\\nTime taken: ' + this.timerSpan.innerText;\r\n        }\r\n        if (this.mode === GameMode.Network) {\r\n            winMsg += '\\n';\r\n            if (this.socket.getPlayerColor() === this.turn) {\r\n                winMsg += 'You win!';\r\n                Utils.playSound(Sound.Win);\r\n            } else {\r\n                winMsg += 'You lose!';\r\n                Utils.playSound(Sound.Lose);\r\n            }\r\n        } else {\r\n            Utils.playSound(Sound.Win);\r\n        }\r\n        alert(winMsg);\r\n    }\r\n\r\n    private closeGameByWinning() {\r\n        if (this.mode === GameMode.SamePC) {\r\n            // Clear game data\r\n            localStorage.clear();\r\n        }\r\n\r\n        this.cleanUpEvents();\r\n        this.stopTimer();\r\n        this.clearPlayerNames();\r\n\r\n        if (this.exitBtn) {\r\n            this.exitBtn.classList.add('hide');\r\n        }\r\n\r\n        this.resetValues();\r\n\r\n        // Run delegate function to return to main menu, in case it is defined\r\n        if (this.onGameEnd) {\r\n            setTimeout(this.onGameEnd, 3000);\r\n        }\r\n    }\r\n\r\n    private paintDotToDrop(column: number) {\r\n        this.context.beginPath();\r\n        this.context.arc(50 + column * this.colGap, this.circleRadius, this.circleRadius, 0, 2 * Math.PI);\r\n        this.context.closePath();\r\n        this.context.fill();\r\n    }\r\n\r\n    private beforeUnload = (event) => {\r\n        if (this.mode === GameMode.SamePC) {\r\n            this.saveGame();\r\n        } else if (this.mode === GameMode.Network) {\r\n            // Display default dialog before closing\r\n            event.preventDefault();\r\n            event.returnValue = ''; // Required by Chrome\r\n        }\r\n    };\r\n\r\n    private timerCallback = () => {\r\n        if (this.mode !== GameMode.Network || this.opponentConnected()) {\r\n            this.secondsRunning++;\r\n            let minutes: number = Math.floor(this.secondsRunning / 60);\r\n            let seconds: number = this.secondsRunning % 60;\r\n            this.timerSpan.innerText = minutes + ':' + (seconds < 10 ? '0' : '') + seconds;\r\n        }\r\n        \r\n        if (!this.timerSpan.classList.contains('hide')) {\r\n            this.timeout = setTimeout(this.timerCallback, 1000);\r\n        } else {\r\n            clearTimeout(this.timeout);\r\n        }\r\n    };\r\n\r\n    private pageVisibilityChange = () => {\r\n        if (this.mode !== GameMode.Network) {\r\n            if (document.hidden) {\r\n                clearTimeout(this.timeout);\r\n            } else {\r\n                this.timeout = setTimeout(this.timerCallback, 1000);\r\n            }\r\n        }\r\n    };\r\n\r\n    private clearUpper() {\r\n        this.context.clearRect(0, 0, this.canvas.width, 70);\r\n    }\r\n\r\n    private checkDotCount(column: number, row: number): number {\r\n        let count: number = row;\r\n        let dotCount: number = 0;\r\n\r\n        // Vertical check\r\n        while (dotCount < 4 && count < Game.rows && this.board[column][count] === this.turn) {\r\n            dotCount++;\r\n            count++;\r\n        }\r\n        \r\n        if (dotCount < 4) {\r\n\r\n            // Horizontal check\r\n            dotCount = 0;\r\n            count = column;\r\n            while (count < Game.columns && this.board[count][row] === this.turn) {\r\n                dotCount++;\r\n                count++;\r\n            }\r\n            count = column - 1;\r\n            while (count > -1 && this.board[count][row] === this.turn) {\r\n                dotCount++;\r\n                count--;\r\n            }\r\n        \r\n            // Diagonal checks\r\n            if (dotCount < 4) {\r\n                dotCount = 0;\r\n                let rowCount: number = row - 1;\r\n                let colCount: number = column + 1;\r\n                while (dotCount < 4 && rowCount > -1 &&  colCount < Game.columns && this.board[colCount][rowCount] === this.turn) {\r\n                    dotCount++;\r\n                    colCount++; //right columns\r\n                    rowCount--; //upper rows\r\n                }\r\n                colCount = column;\r\n                rowCount = row;\r\n                while (dotCount < 4 && rowCount < Game.rows && colCount > -1 && this.board[colCount][rowCount] === this.turn) {\r\n                    dotCount++;\r\n                    colCount--; // left columns\r\n                    rowCount++; // lower rows\r\n                }\r\n                \r\n                if (dotCount < 4) {\r\n                    dotCount = 0;\r\n                    rowCount = row - 1;\r\n                    colCount = column - 1;\r\n                    while (dotCount < 4 && rowCount > -1 && colCount > -1 && this.board[colCount][rowCount] === this.turn) {\r\n                        dotCount++;\r\n                        colCount--; // left columns\r\n                        rowCount--; // upper rows\r\n                    }\r\n                    colCount = column;\r\n                    rowCount = row;\r\n                    while (dotCount < 4 && rowCount < Game.rows && colCount < Game.columns && this.board[colCount][rowCount] === this.turn) {\r\n                        dotCount++;\r\n                        colCount++; // right columns\r\n                        rowCount++; // lower rows\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return dotCount;\r\n    }\r\n\r\n    private cleanUpEvents() {\r\n        this.canvas.removeEventListener('mousemove', this.canvasMousemove, false);\r\n        this.canvas.removeEventListener('click', this.canvasClick, false);\r\n        window.removeEventListener('beforeunload', this.beforeUnload);\r\n        window.removeEventListener('resize', this.resizeCanvas);\r\n        document.removeEventListener('changevisibility', this.pageVisibilityChange);\r\n    }\r\n\r\n    private saveGame() {\r\n        localStorage.setItem('nextTurn', this.turn.toString());\r\n\t    localStorage.setItem('board', JSON.stringify(this.board));\r\n        localStorage.setItem('playerRed', this.playerRed);\r\n        localStorage.setItem('playerGreen', this.playerGreen);\r\n        localStorage.setItem('secondsRunning', this.secondsRunning.toString());\r\n    }\r\n\r\n    private restoreLastGame() {\r\n        let nextTurn: string = localStorage.getItem('nextTurn');\r\n        if (nextTurn === Dot.Red) {\r\n            this.turn = Dot.Red;\r\n        } else if (nextTurn === Dot.Green) {\r\n            this.turn = Dot.Green;\r\n        }\r\n        \r\n        this.playerRed = localStorage.getItem('playerRed');\r\n        this.playerGreen = localStorage.getItem('playerGreen');\r\n        this.board = JSON.parse(localStorage.getItem('board'));\r\n        this.secondsRunning = parseInt(localStorage.getItem('secondsRunning'));\r\n    }\r\n\r\n    public exit() {\r\n        let exitConfirmation: boolean = (this.mode === GameMode.Network ? confirm('Network game in progress. Are you sure you want to quit?') : true);\r\n\r\n        if (exitConfirmation) {\r\n            this.cleanUpEvents();\r\n            if (this.mode === GameMode.SamePC) {\r\n                this.saveGame();\r\n            } else if (this.mode === GameMode.Network) {\r\n                this.socket.close();\r\n            }\r\n            this.onGameEnd();\r\n            this.stopTimer();\r\n            this.clearPlayerNames();\r\n            this.resetValues();\r\n        }\r\n    }\r\n\r\n    private setTimer() {\r\n        if (this.timerSpan) {\r\n            this.timerSpan.classList.remove('hide');\r\n            this.timerCallback();\r\n        }\r\n    }\r\n\r\n    private stopTimer() {\r\n        if (this.timeout) {\r\n            clearTimeout(this.timeout);\r\n            this.timerSpan.innerText = '';\r\n            this.timerSpan.classList.add('hide');\r\n        }\r\n    }\r\n\r\n    private clearPlayerNames() {\r\n        if (this.playerGreenSpan) {\r\n            this.playerGreenSpan.innerText = '';\r\n        }\r\n        if (this.playerRedSpan) {\r\n            this.playerRedSpan.innerText = '';\r\n        }\r\n    }\r\n\r\n    private resizeCanvas = () => {\r\n        this.canvas.height = window.innerHeight - 100;\r\n        this.canvas.width = window.innerWidth;\r\n\r\n        if (this.canvas.width < 1000) {\r\n            this.circleRadius = 20; // Mobile/tablet\r\n        } else {\r\n            this.circleRadius = 30; // Desktop\r\n        }\r\n\r\n        if (this.canvas.height > this.canvas.width) {\r\n            this.colGap = this.canvas.width / Game.columns;\r\n            this.rowGap = this.canvas.height / Game.rows;\r\n        } else {\r\n            this.colGap = this.canvas.width / Game.columns;\r\n            this.rowGap = 65;\r\n        }\r\n\r\n        this.paintBoard();\r\n    };\r\n\r\n    private defineSocket() {\r\n        this.socket = new Socket();\r\n        this.socket.onMessageCallback = this.socketMessage;\r\n    }\r\n\r\n    private socketMessage = (messageData) => {\r\n        if (messageData.opponentName && this.socket) {\r\n            if (this.socket.getPlayerColor() === Dot.Red) {\r\n                this.playerGreen = messageData.opponentName;\r\n                if (this.playerGreenSpan) {\r\n                    this.playerGreenSpan.innerText = this.playerGreen;\r\n                }\r\n            } else if (this.socket.getPlayerColor() === Dot.Green) {\r\n                this.playerRed = messageData.opponentName;\r\n                if (this.playerRedSpan) {\r\n                    this.playerRedSpan.innerText = this.playerRed;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (messageData.color && this.socket) {\r\n            if (messageData.color === Dot.Red) {\r\n                this.playerRed = this.socket.getPlayerName();\r\n                if (this.playerRedSpan) {\r\n                    this.playerRedSpan.innerText = this.playerRed;\r\n                }\r\n            } else if (messageData.color === Dot.Green) {\r\n                this.playerGreen = this.socket.getPlayerName();\r\n                if (this.playerGreenSpan) {\r\n                    this.playerGreenSpan.innerText = this.playerGreen;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (messageData.win) {\r\n            this.closeGameByWinning();\r\n        }\r\n\r\n        if (!isNaN(messageData.column) && messageData.action === 'mousemove') {\r\n            this.moveDot(messageData.column);\r\n        }\r\n\r\n        if (!isNaN(messageData.column) && messageData.action === 'click') {\r\n            this.landDot(messageData.column);\r\n        }\r\n    };\r\n\r\n    private opponentConnected(): boolean {\r\n        // Return true for network play when both player names are defined (i.e. both connected)\r\n        return this.mode === GameMode.Network && !!this.playerRed && !!this.playerGreen;\r\n    }\r\n\r\n    private isBoardFull(): boolean {\r\n        let full: boolean = true;\r\n        for (let col: number = 0; col < Game.columns; col++) {\r\n            // Check upper row in every column\r\n            if (this.board[col][0] === Dot.Empty) {\r\n                full = false;\r\n                break;\r\n            }\r\n        }\r\n        return full;\r\n    }\r\n\r\n    private resetValues() {\r\n        this.secondsRunning = 0;\r\n        this.turn = Dot.Red;\r\n        this.initBoard();\r\n        this.playerRed = null;\r\n        this.playerGreen = null;\r\n    }\r\n\r\n}","export class Position {\r\n    public x: number;\r\n    public y: number;\r\n\r\n    constructor(x: number, y: number) {\r\n        this.x = x;\r\n        this.y = y;\r\n    }\r\n\r\n    public static getCursorPosition(event, canvas): Position {\r\n        let x: number;\r\n        let y: number;\r\n        if (event.pageX !== undefined || event.pageY !== undefined) {\r\n            x = event.pageX;\r\n            y = event.pageY;\r\n        }\r\n        else {\r\n            x = event.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\r\n            y = event.clientY + document.body.scrollTop + document.documentElement.scrollTop;\r\n        }\r\n        x -= canvas.offsetLeft;\r\n        y -= canvas.offsetTop;\r\n        return new Position(x, y);\r\n    }\r\n}","import { Dot } from \"./enums/dot\";\r\nimport { Utils } from \"./utils\";\r\n\r\nexport class Socket {\r\n    private webSocket: WebSocket;\r\n    private playerColor: Dot;\r\n    private playerName: string;\r\n    private gameId: number;\r\n    public onMessageCallback: Function;\r\n\r\n    public constructor() {\r\n        let url: string;\r\n        if (Utils.isLocal()) {\r\n            url = 'ws://localhost:3000';\r\n        } else {\r\n            url = 'wss://daniels-connect4-server.adaptable.app';\r\n        }\r\n\r\n        this.webSocket = new WebSocket(url);\r\n\r\n        this.webSocket.onmessage = this.onMessage;\r\n        this.webSocket.onerror = this.onError;\r\n    }\r\n\r\n    public send(data: object) {\r\n        this.webSocket.send(JSON.stringify(data));\r\n    }\r\n\r\n    public close() {\r\n        this.webSocket.close();\r\n        this.webSocket = null;\r\n    }\r\n\r\n    public getPlayerColor(): Dot {\r\n        return this.playerColor;\r\n    }\r\n\r\n    public getPlayerName(): string {\r\n        return this.playerName;\r\n    }\r\n\r\n    private onMessage = (event) => {\r\n        let messageData = JSON.parse(event.data);\r\n\r\n        if (!this.gameId && messageData.gameId) {\r\n            this.gameId = messageData.gameId;\r\n        }\r\n\r\n        if (messageData.message) {\r\n            alert(messageData.message);\r\n        }\r\n\r\n        if (!this.playerColor && messageData.color) {\r\n            this.playerColor = messageData.color;\r\n\r\n            this.playerName = prompt('You are ' + this.playerColor + '. Please enter your name.');\r\n            \r\n            let data = {\r\n                name: this.playerName\r\n            };\r\n            this.send(data);\r\n        }\r\n\r\n        if (this.onMessageCallback) {\r\n            this.onMessageCallback(messageData);\r\n        }\r\n    };\r\n\r\n    private onError = () => {\r\n        alert('Problem connecting to server!');\r\n    };\r\n}","export class Utils {\r\n    public static isLocal(): boolean {\r\n        return location.protocol === 'file:'\r\n            || location.hostname === 'localhost';\r\n    }\r\n\r\n    public static playSound(path: string) {\r\n        let audio = new Audio(path);\r\n        audio.play();\r\n    }\r\n}","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import { Game } from \"./lib/game\";\r\nimport { GameMode } from \"./lib/enums/game-mode\";\r\n\r\nlet connect4: Game;\r\n\r\nlet menu = document.getElementById('menu');\r\nlet samePCBtn = document.getElementById('samePC');\r\nlet socketsBtn = document.getElementById('sockets');\r\nlet creditsBtn = document.getElementById('credits');\r\n\r\nlet exitBtn = document.getElementById('exitBtn');\r\n\r\nlet canvas = document.getElementById('board');\r\n\r\nsamePCBtn.addEventListener('click', () => {\r\n    initGame(GameMode.SamePC);\r\n}, false);\r\n\r\nsocketsBtn.addEventListener('click', () => {\r\n    initGame(GameMode.Network);\r\n}, false);\r\n\r\ncreditsBtn.addEventListener('click', () => {\r\n    open('contributors.html');\r\n}, false);\r\n\r\nexitBtn.addEventListener('click', () => {\r\n    connect4.exit();\r\n}, false);\r\n\r\nfunction initGame(mode: GameMode) {\r\n    connect4 = Game.getInstance('board', 'exitBtn', 'timer', 'playerRed', 'playerGreen');\r\n    connect4.mode = mode;\r\n    connect4.onGameEnd = () => {\r\n        menu.classList.remove('hide');\r\n        canvas.classList.add('hide');\r\n        exitBtn.classList.add('hide');\r\n    };\r\n    connect4.start();\r\n\r\n    menu.classList.add('hide');\r\n    canvas.classList.remove('hide');\r\n    exitBtn.classList.remove('hide');\r\n}"],"names":["Dot","GameMode","Sound","canvasId","exitBtnId","timerId","playerRedId","playerGreenId","board","Array","Game","columns","turn","Red","canvasMousemove","event","mode","SamePC","socket","getPlayerColor","opponentConnected","position","Position","getCursorPosition","canvas","column","Math","round","x","colGap","moveDot","Network","data","action","send","canvasClick","landDot","beforeUnload","saveGame","preventDefault","returnValue","timerCallback","secondsRunning","minutes","floor","seconds","timerSpan","innerText","classList","contains","clearTimeout","timeout","setTimeout","pageVisibilityChange","document","hidden","resizeCanvas","height","window","innerHeight","width","innerWidth","circleRadius","rowGap","rows","paintBoard","socketMessage","messageData","opponentName","playerGreen","playerGreenSpan","Green","playerRed","playerRedSpan","color","getPlayerName","win","closeGameByWinning","isNaN","this","getElementById","context","getContext","initBoard","exitBtn","getInstance","instance","col","row","Empty","start","checkGameData","setUpPlayerNames","defineSocket","printPlayerNames","setGameEvents","setTimer","localStorage","getItem","nextTurn","confirm","restoreLastGame","clear","prompt","waiting","boardGradient","createLinearGradient","addColorStop","fillStyle","fillRect","beginPath","arc","PI","closePath","fill","addEventListener","switchTurn","clearUpper","paintDotToDrop","r","checkDotCount","winner","winDialog","isBoardFull","alert","Utils","playSound","LandDot","winMsg","Win","Lose","cleanUpEvents","stopTimer","clearPlayerNames","add","resetValues","onGameEnd","clearRect","count","dotCount","rowCount","colCount","removeEventListener","setItem","toString","JSON","stringify","parse","parseInt","exit","close","remove","Socket","onMessageCallback","full","y","undefined","pageX","pageY","clientX","body","scrollLeft","documentElement","clientY","scrollTop","offsetLeft","offsetTop","url","onMessage","gameId","message","playerColor","playerName","name","onError","isLocal","webSocket","WebSocket","onmessage","onerror","location","protocol","hostname","path","Audio","play","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","connect4","menu","samePCBtn","socketsBtn","creditsBtn","initGame","open"],"sourceRoot":""}