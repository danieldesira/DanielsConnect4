(()=>{"use strict";var e,t,n,o,r,a,i={769:(e,t)=>{var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.Game=t.GameMode=void 0,function(e){e[e.EMPTY=0]="EMPTY",e[e.RED=1]="RED",e[e.GREEN=2]="GREEN"}(n||(n={})),function(e){e[e.SAME_PC=1]="SAME_PC"}(o=t.GameMode||(t.GameMode={}));var r=function(){function e(t,o,r,a,i){void 0===o&&(o=null),void 0===r&&(r=null),void 0===a&&(a=null),void 0===i&&(i=null);var s=this;this.board=new Array(e.columns),this.turn=n.RED,this.moveDot=function(e){s.clearUpper();var t=s.getCursorPosition(e),o=Math.round(t.x-50)/110;s.turn==n.RED?s.context.fillStyle="red":s.turn==n.GREEN&&(s.context.fillStyle="greenyellow"),s.context.beginPath(),s.context.arc(50+120*o,35,35,0,2*Math.PI),s.context.closePath(),s.context.fill()},this.landDot=function(t){var o,r=s.getCursorPosition(t),a=Math.round((r.x-50)/110);if(0===s.board[a][0]){for(var i=e.rows-1;i>-1;i--)if(0===s.board[a][i]){s.board[a][i]=s.turn,o=i;break}if(s.turn===n.RED?s.context.fillStyle="red":s.turn===n.GREEN&&(s.context.fillStyle="greenyellow"),s.context.beginPath(),s.context.arc(50+110*a,150+110*i,30,0,2*Math.PI),s.context.closePath(),s.context.fill(),s.checkTileCount(a,o)>3){var l="";s.turn===n.RED?l=s.playerRed+" (Red)":s.turn===n.GREEN&&(l=s.playerGreen+" (Green)"),s.exitBtn&&s.exitBtn.classList.add("hide");var c=l+" wins!";s.timerSpan&&(c+="\nTime taken: "+s.timerSpan.innerText),alert(c),localStorage.clear(),s.cleanUpEvents(),s.stopTimer(),s.clearPlayerNames(),void 0!==s.onGameEnd&&null!==s.onGameEnd&&setTimeout(s.onGameEnd,3e3)}s.turn===n.RED?s.turn=n.GREEN:s.turn===n.GREEN&&(s.turn=n.RED)}},this.beforeUnload=function(){s.saveGame()},this.timerCallback=function(){s.secondsRunning++;var e=Math.floor(s.secondsRunning/60),t=s.secondsRunning%60;s.timerSpan.innerText=e+":"+(t<10?"0":"")+t},this.canvas=document.getElementById(t),this.context=this.canvas.getContext("2d");for(var l=0;l<e.columns;l++){this.board[l]=new Array(e.rows);for(var c=0;c<e.rows;c++)this.board[l][c]=n.EMPTY}null!==o&&(this.exitBtn=document.getElementById(o)),null!==r&&(this.timerSpan=document.getElementById(r),this.secondsRunning=0),null!==a&&(this.playerRedSpan=document.getElementById(a)),null!==i&&(this.playerGreenSpan=document.getElementById(i))}return e.prototype.start=function(){this.checkGameData(),this.setUpPlayerNames(),this.paintBoard(),this.setGameEvents(),this.setTimer()},e.prototype.checkGameData=function(){if(this.mode===o.SAME_PC){var e=localStorage.getItem("board"),t=localStorage.getItem("nextTurn");e&&t&&(confirm("Do you want to continue playing the previous game? OK/Cancel")?this.restoreLastGame():localStorage.clear())}},e.prototype.setUpPlayerNames=function(){this.mode===o.SAME_PC&&(localStorage.getItem("playerRed")&&localStorage.getItem("playerGreen")||(this.playerRed=prompt("Please enter name for Red Player!"),this.playerGreen=prompt("Please enter name for Green Player!"))),this.playerGreenSpan&&(this.playerGreenSpan.innerText=this.playerGreen),this.playerRedSpan&&(this.playerRedSpan.innerText=this.playerRed)},e.prototype.paintBoard=function(){var t=this.context.createLinearGradient(0,0,this.canvas.width,0);t.addColorStop(0,"blue"),t.addColorStop(1,"aqua"),this.context.fillStyle=t,this.context.fillRect(0,70,this.canvas.width,this.canvas.height);for(var o=e.columns-1;o>=0;o--)for(var r=e.rows-1;r>=0;r--)this.board[o][r]===n.RED?this.context.fillStyle="red":this.board[o][r]===n.GREEN?this.context.fillStyle="greenyellow":this.context.fillStyle="black",this.context.beginPath(),this.context.arc(50+110*o,150+110*r,30,0,2*Math.PI),this.context.closePath(),this.context.fill()},e.prototype.getCursorPosition=function(e){var t,n;return void 0!==e.pageX||void 0!==e.pageY?(t=e.pageX,n=e.pageY):(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),t-=this.canvas.offsetLeft,n-=this.canvas.offsetTop,new a(t,n)},e.prototype.setGameEvents=function(){this.canvas.addEventListener("mousemove",this.moveDot,!1),this.canvas.addEventListener("click",this.landDot,!1),window.addEventListener("beforeunload",this.beforeUnload)},e.prototype.clearUpper=function(){this.context.clearRect(0,0,this.canvas.width,70)},e.prototype.checkTileCount=function(t,n){for(var o=n,r=0;r<4&&o<e.rows&&this.board[t][o]===this.turn;)r++,o++;if(r<4){for(r=0,o=t;o<e.columns&&this.board[o][n]===this.turn;)r++,o++;for(o=t-1;o>-1&&this.board[o][n]===this.turn;)r++,o--;if(r<4){r=0;for(var a=n-1,i=t+1;r<4&&a>-1&&i<e.columns&&this.board[i][a]===this.turn;)r++,i++,a--;for(i=t,a=n;r<4&&a<e.rows&&i>-1&&this.board[i][a]===this.turn;)r++,i--,a++;if(r<4){for(r=0,a=n-1,i=t-1;r<4&&a>-1&&i>-1&&this.board[i][a]===this.turn;)r++,i--,a--;for(i=t,a=n;r<4&&a<e.rows&&i<e.columns&&this.board[i][a]===this.turn;)r++,i++,a++}}}return r},e.prototype.cleanUpEvents=function(){this.canvas.removeEventListener("mousemove",this.moveDot,!1),this.canvas.removeEventListener("click",this.landDot,!1),window.removeEventListener("beforeunload",this.beforeUnload)},e.prototype.saveGame=function(){localStorage.setItem("nextTurn",this.turn.toString()),localStorage.setItem("board",JSON.stringify(this.board)),localStorage.setItem("playerRed",this.playerRed),localStorage.setItem("playerGreen",this.playerGreen),localStorage.setItem("secondsRunning",this.secondsRunning.toString())},e.prototype.restoreLastGame=function(){this.turn=parseInt(localStorage.getItem("nextTurn")),this.playerRed=localStorage.getItem("playerRed"),this.playerGreen=localStorage.getItem("playerGreen"),this.board=JSON.parse(localStorage.getItem("board")),this.secondsRunning=parseInt(localStorage.getItem("secondsRunning"))},e.prototype.exit=function(){this.cleanUpEvents(),this.saveGame(),this.onGameEnd(),this.stopTimer(),this.clearPlayerNames()},e.prototype.setTimer=function(){this.timerSpan&&(this.timerCallback(),this.timerInterval=setInterval(this.timerCallback,1e3),this.timerSpan.classList.remove("hide"))},e.prototype.stopTimer=function(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerSpan.classList.add("hide"))},e.prototype.clearPlayerNames=function(){this.playerGreenSpan&&(this.playerGreenSpan.innerText=""),this.playerRedSpan&&(this.playerRedSpan.innerText="")},e.columns=9,e.rows=8,e}();t.Game=r;var a=function(e,t){this.x=e,this.y=t}}},s={};t=document.getElementById("menu"),n=document.getElementById("samePC"),o=document.getElementById("exitBtn"),r=function e(t){var n=s[t];if(void 0!==n)return n.exports;var o=s[t]={exports:{}};return i[t](o,o.exports,e),o.exports}(769),a=document.getElementById("board"),n.addEventListener("click",(function(){(e=new r.Game("board","exitBtn","timer","playerRed","playerGreen")).mode=r.GameMode.SAME_PC,e.onGameEnd=function(){t.classList.remove("hide"),a.classList.add("hide"),o.classList.add("hide")},e.start(),t.classList.add("hide"),a.classList.remove("hide"),o.classList.remove("hide")}),!1),o.addEventListener("click",(function(){e.exit()}),!1)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNUc0MsS0FBSzJCLEVBQUlBLENBQ2IsQyxHQ3RZQStCLEVBQTJCLENBQUMsRUZDNUJ6SCxFQUFPZ0UsU0FBU0MsZUFBZSxRQUMvQmhFLEVBQVkrRCxTQUFTQyxlQUFlLFVBRXBDL0QsRUFBVThELFNBQVNDLGVBQWUsV0FFdEMsRUVIQSxTQUFTeUQsRUFBb0JDLEdBRTVCLElBQUlDLEVBQWVILEVBQXlCRSxHQUM1QyxRQUFxQnRFLElBQWpCdUUsRUFDSCxPQUFPQSxFQUFhQyxRQUdyQixJQUFJQyxFQUFTTCxFQUF5QkUsR0FBWSxDQUdqREUsUUFBUyxDQUFDLEdBT1gsT0FIQUUsRUFBb0JKLEdBQVVHLEVBQVFBLEVBQU9ELFFBQVNILEdBRy9DSSxFQUFPRCxPQUNmLENGZkEsTUFFSTFILEVBQVM2RCxTQUFTQyxlQUFlLFNBRXJDaEUsRUFBVXFHLGlCQUFpQixTQUFTLFlBQ2hDdkcsRUFBVyxJQUFJLEVBQUFjLEtBQUssUUFBUyxVQUFXLFFBQVMsWUFBYSxnQkFDckRnRSxLQUFPLEVBQUF4RSxTQUFTeUUsUUFDekIvRSxFQUFTdUQsVUFBWSxXQUNqQnRELEVBQUswQyxVQUFVNkUsT0FBTyxRQUN0QnBILEVBQU91QyxVQUFVQyxJQUFJLFFBQ3JCekMsRUFBUXdDLFVBQVVDLElBQUksT0FDMUIsRUFDQTVDLEVBQVN3RSxRQUVUdkUsRUFBSzBDLFVBQVVDLElBQUksUUFDbkJ4QyxFQUFPdUMsVUFBVTZFLE9BQU8sUUFDeEJySCxFQUFRd0MsVUFBVTZFLE9BQU8sT0FDN0IsSUFBRyxHQUVIckgsRUFBUW9HLGlCQUFpQixTQUFTLFdBQzlCdkcsRUFBU3FILE1BQ2IsSUFBRyxFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL21haW4udHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWUudHMiLCJ3ZWJwYWNrOi8vL3dlYnBhY2svYm9vdHN0cmFwIl0sInNvdXJjZXNDb250ZW50IjpbImxldCBjb25uZWN0NDogR2FtZTtcclxuXHJcbmxldCBtZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21lbnUnKTtcclxubGV0IHNhbWVQQ0J0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzYW1lUEMnKTtcclxuXHJcbmxldCBleGl0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4aXRCdG4nKTtcclxuXHJcbmltcG9ydCB7IEdhbWUsIEdhbWVNb2RlIH0gZnJvbSBcIi4vZ2FtZVwiO1xyXG5cclxubGV0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdib2FyZCcpO1xyXG5cclxuc2FtZVBDQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgY29ubmVjdDQgPSBuZXcgR2FtZSgnYm9hcmQnLCAnZXhpdEJ0bicsICd0aW1lcicsICdwbGF5ZXJSZWQnLCAncGxheWVyR3JlZW4nKTtcclxuICAgIGNvbm5lY3Q0Lm1vZGUgPSBHYW1lTW9kZS5TQU1FX1BDO1xyXG4gICAgY29ubmVjdDQub25HYW1lRW5kID0gKCkgPT4ge1xyXG4gICAgICAgIG1lbnUuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpO1xyXG4gICAgICAgIGNhbnZhcy5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XHJcbiAgICAgICAgZXhpdEJ0bi5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XHJcbiAgICB9O1xyXG4gICAgY29ubmVjdDQuc3RhcnQoKTtcclxuXHJcbiAgICBtZW51LmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcclxuICAgIGNhbnZhcy5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJyk7XHJcbiAgICBleGl0QnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKTtcclxufSwgZmFsc2UpO1xyXG5cclxuZXhpdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIGNvbm5lY3Q0LmV4aXQoKTtcclxufSwgZmFsc2UpOyIsImVudW0gVGlsZSB7XHJcbiAgICBFTVBUWSA9IDAsXHJcbiAgICBSRUQgPSAxLFxyXG4gICAgR1JFRU4gPSAyXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEdhbWVNb2RlIHtcclxuICAgIFNBTUVfUEMgPSAxXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBHYW1lIHtcclxuXHJcbiAgICBwcml2YXRlIHN0YXRpYyBjb2x1bW5zOiBudW1iZXIgPSA5O1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgcm93czogbnVtYmVyID0gODtcclxuXHJcbiAgICBwcml2YXRlIGNhbnZhczogYW55O1xyXG4gICAgcHJpdmF0ZSBjb250ZXh0OiBhbnk7XHJcbiAgICBwcml2YXRlIGJvYXJkOiBBcnJheTxBcnJheTxUaWxlPj4gPSBuZXcgQXJyYXkoR2FtZS5jb2x1bW5zKTtcclxuXHJcbiAgICBwcml2YXRlIGV4aXRCdG46IGFueTtcclxuICAgIHByaXZhdGUgdGltZXJTcGFuOiBhbnk7XHJcbiAgICBwcml2YXRlIHBsYXllclJlZFNwYW46IGFueTtcclxuICAgIHByaXZhdGUgcGxheWVyR3JlZW5TcGFuOiBhbnk7XHJcblxyXG4gICAgcHJpdmF0ZSB0dXJuOiBUaWxlID0gVGlsZS5SRUQ7XHJcblxyXG4gICAgcHJpdmF0ZSBwbGF5ZXJSZWQ6IHN0cmluZztcclxuICAgIHByaXZhdGUgcGxheWVyR3JlZW46IHN0cmluZztcclxuXHJcbiAgICBwdWJsaWMgbW9kZTogR2FtZU1vZGU7XHJcbiAgICBwdWJsaWMgb25HYW1lRW5kOiBGdW5jdGlvbjtcclxuXHJcbiAgICBwcml2YXRlIHNlY29uZHNSdW5uaW5nOiBudW1iZXI7XHJcbiAgICBwcml2YXRlIHRpbWVySW50ZXJ2YWw6IGFueTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihjYW52YXNJZDogc3RyaW5nLFxyXG4gICAgICAgICAgICAgICAgZXhpdEJ0bklkOiBzdHJpbmcgPSBudWxsLFxyXG4gICAgICAgICAgICAgICAgdGltZXJJZDogc3RyaW5nID0gbnVsbCxcclxuICAgICAgICAgICAgICAgIHBsYXllclJlZElkOiBzdHJpbmcgPSBudWxsLFxyXG4gICAgICAgICAgICAgICAgcGxheWVyR3JlZW5JZDogc3RyaW5nID0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY2FudmFzSWQpO1xyXG4gICAgICAgIHRoaXMuY29udGV4dCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJyk7XHJcblxyXG4gICAgICAgIC8vIEluaXRpYWxpc2UgYm9hcmQgd2l0aCBlbXB0eSB0aWxlc1xyXG4gICAgICAgIGZvciAobGV0IGNvbCA9IDA7IGNvbCA8IEdhbWUuY29sdW1uczsgY29sKyspIHtcclxuICAgICAgICAgICAgdGhpcy5ib2FyZFtjb2xdID0gbmV3IEFycmF5KEdhbWUucm93cyk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IEdhbWUucm93czsgcm93Kyspe1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtjb2xdW3Jvd10gPSBUaWxlLkVNUFRZO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZXhpdEJ0bklkICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZXhpdEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGV4aXRCdG5JZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGltZXJJZCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVyU3BhbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRpbWVySWQpO1xyXG4gICAgICAgICAgICB0aGlzLnNlY29uZHNSdW5uaW5nID0gMDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChwbGF5ZXJSZWRJZCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllclJlZFNwYW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwbGF5ZXJSZWRJZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAocGxheWVyR3JlZW5JZCAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllckdyZWVuU3BhbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBsYXllckdyZWVuSWQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhcnQoKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja0dhbWVEYXRhKCk7XHJcbiAgICAgICAgdGhpcy5zZXRVcFBsYXllck5hbWVzKCk7XHJcbiAgICAgICAgdGhpcy5wYWludEJvYXJkKCk7XHJcbiAgICAgICAgdGhpcy5zZXRHYW1lRXZlbnRzKCk7XHJcbiAgICAgICAgdGhpcy5zZXRUaW1lcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2hlY2tHYW1lRGF0YSgpe1xyXG4gICAgICAgIGlmICh0aGlzLm1vZGUgPT09IEdhbWVNb2RlLlNBTUVfUEMpIHtcclxuICAgICAgICAgICAgbGV0IGJvYXJkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2JvYXJkJyk7XHJcbiAgICAgICAgICAgIGxldCBuZXh0VHVybiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCduZXh0VHVybicpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKGJvYXJkICYmIG5leHRUdXJuKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgcmVzdG9yZSA9IGNvbmZpcm0oJ0RvIHlvdSB3YW50IHRvIGNvbnRpbnVlIHBsYXlpbmcgdGhlIHByZXZpb3VzIGdhbWU/IE9LL0NhbmNlbCcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3RvcmUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc3RvcmVMYXN0R2FtZSgpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldFVwUGxheWVyTmFtZXMoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubW9kZSA9PT0gR2FtZU1vZGUuU0FNRV9QQykge1xyXG4gICAgICAgICAgICBpZiAoIWxvY2FsU3RvcmFnZS5nZXRJdGVtKCdwbGF5ZXJSZWQnKSB8fCAhbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3BsYXllckdyZWVuJykpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyUmVkID0gcHJvbXB0KCdQbGVhc2UgZW50ZXIgbmFtZSBmb3IgUmVkIFBsYXllciEnKTtcclxuICAgICAgICAgICAgICAgIHRoaXMucGxheWVyR3JlZW4gPSBwcm9tcHQoJ1BsZWFzZSBlbnRlciBuYW1lIGZvciBHcmVlbiBQbGF5ZXIhJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFByaW50IHBsYXllciBuYW1lcyBvbiBzY3JlZW5cclxuICAgICAgICBpZiAodGhpcy5wbGF5ZXJHcmVlblNwYW4pIHtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXJHcmVlblNwYW4uaW5uZXJUZXh0ID0gdGhpcy5wbGF5ZXJHcmVlbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucGxheWVyUmVkU3Bhbikge1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllclJlZFNwYW4uaW5uZXJUZXh0ID0gdGhpcy5wbGF5ZXJSZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcGFpbnRCb2FyZCgpIHtcclxuICAgICAgICBsZXQgYm9hcmRHcmFkaWVudCA9IHRoaXMuY29udGV4dC5jcmVhdGVMaW5lYXJHcmFkaWVudCgwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgMCk7XHJcbiAgICAgICAgYm9hcmRHcmFkaWVudC5hZGRDb2xvclN0b3AoMCwgJ2JsdWUnKTtcclxuICAgICAgICBib2FyZEdyYWRpZW50LmFkZENvbG9yU3RvcCgxLCAnYXF1YScpO1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSBib2FyZEdyYWRpZW50O1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5maWxsUmVjdCgwLCA3MCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGNvbCA9IEdhbWUuY29sdW1ucyAtIDE7IGNvbCA+PSAwOyBjb2wtLSkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCByb3cgPSBHYW1lLnJvd3MgLSAxOyByb3cgPj0gMDsgcm93LS0pIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmJvYXJkW2NvbF1bcm93XSA9PT0gVGlsZS5SRUQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQuZmlsbFN0eWxlID0gJ3JlZCc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuYm9hcmRbY29sXVtyb3ddID09PSBUaWxlLkdSRUVOKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250ZXh0LmZpbGxTdHlsZSA9ICdncmVlbnllbGxvdyc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSAnYmxhY2snO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dC5hcmMoNTAgKyBjb2wgKiAxMTAsIDE1MCArIHJvdyAqIDExMCwgMzAsIDAsIDIgKiBNYXRoLlBJKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dC5maWxsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRDdXJzb3JQb3NpdGlvbihldmVudCk6IFBvc2l0aW9uIHtcclxuICAgICAgICB2YXIgeDogbnVtYmVyO1xyXG4gICAgICAgIHZhciB5OiBudW1iZXI7XHJcbiAgICAgICAgaWYgKGV2ZW50LnBhZ2VYICE9PSB1bmRlZmluZWQgfHwgZXZlbnQucGFnZVkgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICB4ID0gZXZlbnQucGFnZVg7XHJcbiAgICAgICAgICAgIHkgPSBldmVudC5wYWdlWTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHggPSBldmVudC5jbGllbnRYICsgZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0ICsgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQ7XHJcbiAgICAgICAgICAgIHkgPSBldmVudC5jbGllbnRZICsgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgKyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wO1xyXG4gICAgICAgIH1cclxuICAgICAgICB4IC09IHRoaXMuY2FudmFzLm9mZnNldExlZnQ7XHJcbiAgICAgICAgeSAtPSB0aGlzLmNhbnZhcy5vZmZzZXRUb3A7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQb3NpdGlvbih4LCB5KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNldEdhbWVFdmVudHMoKSB7XHJcbiAgICAgICAgdGhpcy5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5tb3ZlRG90LCBmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5jYW52YXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmxhbmREb3QsIGZhbHNlKTtcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgdGhpcy5iZWZvcmVVbmxvYWQpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbW92ZURvdCA9IChldmVudCkgPT4ge1xyXG4gICAgICAgIHRoaXMuY2xlYXJVcHBlcigpO1xyXG5cclxuICAgICAgICBsZXQgcG9zaXRpb246IFBvc2l0aW9uID0gdGhpcy5nZXRDdXJzb3JQb3NpdGlvbihldmVudCk7XHJcbiAgICAgICAgbGV0IGNvbHVtbiA9IE1hdGgucm91bmQocG9zaXRpb24ueCAtIDUwKSAvIDExMDtcclxuICAgICAgICBcclxuICAgICAgICBpZiAodGhpcy50dXJuID09IFRpbGUuUkVEKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSAncmVkJztcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMudHVybiA9PSBUaWxlLkdSRUVOKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSAnZ3JlZW55ZWxsb3cnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5hcmMoNTAgKyBjb2x1bW4gKiAxMjAsIDM1LCAzNSwgMCwgMiAqIE1hdGguUEkpO1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICB0aGlzLmNvbnRleHQuZmlsbCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgbGFuZERvdCA9IChldmVudCkgPT4ge1xyXG4gICAgICAgIGxldCBwb3NpdGlvbiA9IHRoaXMuZ2V0Q3Vyc29yUG9zaXRpb24oZXZlbnQpO1xyXG4gICAgICAgIGxldCBjb2x1bW4gPSBNYXRoLnJvdW5kKChwb3NpdGlvbi54IC0gNTApIC8gMTEwKTtcclxuICAgICAgICBsZXQgcm93OiBudW1iZXI7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmJvYXJkW2NvbHVtbl1bMF0gPT09IDApIHtcclxuXHJcbiAgICAgICAgICAgIC8vIFBsYWNlcyB0aGUgY2lyY2xlIGF0IHRoZSBidXR0b20gb2YgdGhlIGNvbHVtblxyXG4gICAgICAgICAgICBmb3IgKHZhciByID0gR2FtZS5yb3dzIC0gMTsgciA+IC0xOyByLS0pIHtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmJvYXJkW2NvbHVtbl1bcl0gPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW2NvbHVtbl1bcl0gPSB0aGlzLnR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgcm93ID0gcjtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKHRoaXMudHVybiA9PT0gVGlsZS5SRUQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSAncmVkJztcclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnR1cm4gPT09IFRpbGUuR1JFRU4pIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dC5maWxsU3R5bGUgPSAnZ3JlZW55ZWxsb3cnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBEcmF3cyB0aGUgY2lyY2xlIGF0IHRoZSBhcHByb3ByaWF0ZSBwb3NpdGlvblxyXG4gICAgICAgICAgICB0aGlzLmNvbnRleHQuYmVnaW5QYXRoKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5hcmMoNTAgKyBjb2x1bW4gKiAxMTAsIDE1MCArIHIgKiAxMTAsIDMwLCAwLCBNYXRoLlBJICogMik7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGV4dC5jbG9zZVBhdGgoKTtcclxuICAgICAgICAgICAgdGhpcy5jb250ZXh0LmZpbGwoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGxldCBkb3RDb3VudCA9IHRoaXMuY2hlY2tUaWxlQ291bnQoY29sdW1uLCByb3cpO1xyXG5cclxuICAgICAgICAgICAgLy8gQW5ub3VuY2Ugd2lubmVyIGluIGNhc2UgYW55IHBsYXllciBjb21wbGV0ZXMgNCB0aWxlc1xyXG4gICAgICAgICAgICBpZiAoZG90Q291bnQgPiAzKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgd2lubmVyOiBzdHJpbmcgPSAnJztcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnR1cm4gPT09IFRpbGUuUkVEKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2lubmVyID0gdGhpcy5wbGF5ZXJSZWQgKyAnIChSZWQpJztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy50dXJuID09PSBUaWxlLkdSRUVOKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2lubmVyID0gdGhpcy5wbGF5ZXJHcmVlbiArICcgKEdyZWVuKSc7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZXhpdEJ0bikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZXhpdEJ0bi5jbGFzc0xpc3QuYWRkKCdoaWRlJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgbGV0IHdpbk1zZzogc3RyaW5nID0gd2lubmVyICsgJyB3aW5zISc7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50aW1lclNwYW4pIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5Nc2cgKz0gJ1xcblRpbWUgdGFrZW46ICcgKyB0aGlzLnRpbWVyU3Bhbi5pbm5lclRleHQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhbGVydCh3aW5Nc2cpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIENsZWFyIGdhbWUgZGF0YVxyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLmNsZWFyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhblVwRXZlbnRzKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0b3BUaW1lcigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhclBsYXllck5hbWVzKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gUnVuIGRlbGVnYXRlIGZ1bmN0aW9uIHRvIHJldHVybiB0byBtYWluIG1lbnUsIGluIGNhc2UgaXQgaXMgZGVmaW5lZFxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub25HYW1lRW5kICE9PSB1bmRlZmluZWQgJiYgdGhpcy5vbkdhbWVFbmQgIT09IG51bGwpe1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQodGhpcy5vbkdhbWVFbmQsIDMwMDApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBTd2l0Y2hlcyB0dXJuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnR1cm4gPT09IFRpbGUuUkVEKXtcclxuICAgICAgICAgICAgICAgIHRoaXMudHVybiA9IFRpbGUuR1JFRU47XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy50dXJuID09PSBUaWxlLkdSRUVOKXtcclxuICAgICAgICAgICAgICAgIHRoaXMudHVybiA9IFRpbGUuUkVEO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGJlZm9yZVVubG9hZCA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLnNhdmVHYW1lKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHByaXZhdGUgdGltZXJDYWxsYmFjayA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLnNlY29uZHNSdW5uaW5nKys7XHJcbiAgICAgICAgbGV0IG1pbnV0ZXM6IG51bWJlciA9IE1hdGguZmxvb3IodGhpcy5zZWNvbmRzUnVubmluZyAvIDYwKTtcclxuICAgICAgICBsZXQgc2Vjb25kczogbnVtYmVyID0gdGhpcy5zZWNvbmRzUnVubmluZyAlIDYwO1xyXG4gICAgICAgIHRoaXMudGltZXJTcGFuLmlubmVyVGV4dCA9IG1pbnV0ZXMgKyAnOicgKyAoc2Vjb25kcyA8IDEwID8gJzAnIDogJycpICsgc2Vjb25kcztcclxuICAgIH07XHJcblxyXG4gICAgcHJpdmF0ZSBjbGVhclVwcGVyKCkge1xyXG4gICAgICAgIHRoaXMuY29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIDcwKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNoZWNrVGlsZUNvdW50KGNvbHVtbjogbnVtYmVyLCByb3c6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICAgICAgbGV0IGNvdW50OiBudW1iZXIgPSByb3c7XHJcbiAgICAgICAgbGV0IGRvdENvdW50OiBudW1iZXIgPSAwO1xyXG5cclxuICAgICAgICAvLyBWZXJ0aWNhbCBjaGVja1xyXG4gICAgICAgIHdoaWxlIChkb3RDb3VudCA8IDQgJiYgY291bnQgPCBHYW1lLnJvd3MgJiYgdGhpcy5ib2FyZFtjb2x1bW5dW2NvdW50XSA9PT0gdGhpcy50dXJuKSB7XHJcbiAgICAgICAgICAgIGRvdENvdW50Kys7XHJcbiAgICAgICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChkb3RDb3VudCA8IDQpIHtcclxuXHJcbiAgICAgICAgICAgIC8vIEhvcml6b250YWwgY2hlY2tcclxuICAgICAgICAgICAgZG90Q291bnQgPSAwO1xyXG4gICAgICAgICAgICBjb3VudCA9IGNvbHVtbjtcclxuICAgICAgICAgICAgd2hpbGUgKGNvdW50IDwgR2FtZS5jb2x1bW5zICYmIHRoaXMuYm9hcmRbY291bnRdW3Jvd10gPT09IHRoaXMudHVybikge1xyXG4gICAgICAgICAgICAgICAgZG90Q291bnQrKztcclxuICAgICAgICAgICAgICAgIGNvdW50Kys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY291bnQgPSBjb2x1bW4gLSAxO1xyXG4gICAgICAgICAgICB3aGlsZSAoY291bnQgPiAtMSAmJiB0aGlzLmJvYXJkW2NvdW50XVtyb3ddID09PSB0aGlzLnR1cm4pIHtcclxuICAgICAgICAgICAgICAgIGRvdENvdW50Kys7XHJcbiAgICAgICAgICAgICAgICBjb3VudC0tO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIERpYWdvbmFsIGNoZWNrc1xyXG4gICAgICAgICAgICBpZiAoZG90Q291bnQgPCA0KSB7XHJcbiAgICAgICAgICAgICAgICBkb3RDb3VudCA9IDA7XHJcbiAgICAgICAgICAgICAgICBsZXQgcm93Q291bnQ6IG51bWJlciA9IHJvdyAtIDE7XHJcbiAgICAgICAgICAgICAgICBsZXQgY29sQ291bnQ6IG51bWJlciA9IGNvbHVtbiArIDE7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoZG90Q291bnQgPCA0ICYmIHJvd0NvdW50ID4gLTEgJiYgIGNvbENvdW50IDwgR2FtZS5jb2x1bW5zICYmIHRoaXMuYm9hcmRbY29sQ291bnRdW3Jvd0NvdW50XSA9PT0gdGhpcy50dXJuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZG90Q291bnQrKztcclxuICAgICAgICAgICAgICAgICAgICBjb2xDb3VudCsrOyAvL3JpZ2h0IGNvbHVtbnNcclxuICAgICAgICAgICAgICAgICAgICByb3dDb3VudC0tOyAvL3VwcGVyIHJvd3NcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbENvdW50ID0gY29sdW1uO1xyXG4gICAgICAgICAgICAgICAgcm93Q291bnQgPSByb3c7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoZG90Q291bnQgPCA0ICYmIHJvd0NvdW50IDwgR2FtZS5yb3dzICYmIGNvbENvdW50ID4gLTEgJiYgdGhpcy5ib2FyZFtjb2xDb3VudF1bcm93Q291bnRdID09PSB0aGlzLnR1cm4pIHtcclxuICAgICAgICAgICAgICAgICAgICBkb3RDb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbENvdW50LS07IC8vIGxlZnQgY29sdW1uc1xyXG4gICAgICAgICAgICAgICAgICAgIHJvd0NvdW50Kys7IC8vIGxvd2VyIHJvd3NcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKGRvdENvdW50IDwgNCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRvdENvdW50ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICByb3dDb3VudCA9IHJvdyAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgY29sQ291bnQgPSBjb2x1bW4gLSAxO1xyXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChkb3RDb3VudCA8IDQgJiYgcm93Q291bnQgPiAtMSAmJiBjb2xDb3VudCA+IC0xICYmIHRoaXMuYm9hcmRbY29sQ291bnRdW3Jvd0NvdW50XSA9PT0gdGhpcy50dXJuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvdENvdW50Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbENvdW50LS07IC8vIGxlZnQgY29sdW1uc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByb3dDb3VudC0tOyAvLyB1cHBlciByb3dzXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbENvdW50ID0gY29sdW1uO1xyXG4gICAgICAgICAgICAgICAgICAgIHJvd0NvdW50ID0gcm93O1xyXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlIChkb3RDb3VudCA8IDQgJiYgcm93Q291bnQgPCBHYW1lLnJvd3MgJiYgY29sQ291bnQgPCBHYW1lLmNvbHVtbnMgJiYgdGhpcy5ib2FyZFtjb2xDb3VudF1bcm93Q291bnRdID09PSB0aGlzLnR1cm4pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZG90Q291bnQrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29sQ291bnQrKzsgLy8gcmlnaHQgY29sdW1uc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByb3dDb3VudCsrOyAvLyBsb3dlciByb3dzXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZG90Q291bnQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjbGVhblVwRXZlbnRzKCkge1xyXG4gICAgICAgIHRoaXMuY2FudmFzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMubW92ZURvdCwgZmFsc2UpO1xyXG4gICAgICAgIHRoaXMuY2FudmFzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5sYW5kRG90LCBmYWxzZSk7XHJcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JlZm9yZXVubG9hZCcsIHRoaXMuYmVmb3JlVW5sb2FkKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNhdmVHYW1lKCkge1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCduZXh0VHVybicsIHRoaXMudHVybi50b1N0cmluZygpKTtcclxuXHQgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2JvYXJkJywgSlNPTi5zdHJpbmdpZnkodGhpcy5ib2FyZCkpO1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwbGF5ZXJSZWQnLCB0aGlzLnBsYXllclJlZCk7XHJcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3BsYXllckdyZWVuJywgdGhpcy5wbGF5ZXJHcmVlbik7XHJcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3NlY29uZHNSdW5uaW5nJywgdGhpcy5zZWNvbmRzUnVubmluZy50b1N0cmluZygpKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHJlc3RvcmVMYXN0R2FtZSgpIHtcclxuICAgICAgICB0aGlzLnR1cm4gPSBwYXJzZUludChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbmV4dFR1cm4nKSk7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXJSZWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncGxheWVyUmVkJyk7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXJHcmVlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdwbGF5ZXJHcmVlbicpO1xyXG4gICAgICAgIHRoaXMuYm9hcmQgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdib2FyZCcpKTtcclxuICAgICAgICB0aGlzLnNlY29uZHNSdW5uaW5nID0gcGFyc2VJbnQobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3NlY29uZHNSdW5uaW5nJykpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBleGl0KCkge1xyXG4gICAgICAgIHRoaXMuY2xlYW5VcEV2ZW50cygpO1xyXG4gICAgICAgIHRoaXMuc2F2ZUdhbWUoKTtcclxuICAgICAgICB0aGlzLm9uR2FtZUVuZCgpO1xyXG4gICAgICAgIHRoaXMuc3RvcFRpbWVyKCk7XHJcbiAgICAgICAgdGhpcy5jbGVhclBsYXllck5hbWVzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZXRUaW1lcigpIHtcclxuICAgICAgICBpZiAodGhpcy50aW1lclNwYW4pIHtcclxuICAgICAgICAgICAgdGhpcy50aW1lckNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIHRoaXMudGltZXJJbnRlcnZhbCA9IHNldEludGVydmFsKHRoaXMudGltZXJDYWxsYmFjaywgMTAwMCk7XHJcbiAgICAgICAgICAgIHRoaXMudGltZXJTcGFuLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzdG9wVGltZXIoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudGltZXJJbnRlcnZhbCkge1xyXG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXJJbnRlcnZhbCk7XHJcbiAgICAgICAgICAgIHRoaXMudGltZXJTcGFuLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjbGVhclBsYXllck5hbWVzKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnBsYXllckdyZWVuU3Bhbikge1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllckdyZWVuU3Bhbi5pbm5lclRleHQgPSAnJztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucGxheWVyUmVkU3Bhbikge1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllclJlZFNwYW4uaW5uZXJUZXh0ID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxufVxyXG5cclxuY2xhc3MgUG9zaXRpb24ge1xyXG4gICAgcHVibGljIHg6IG51bWJlcjtcclxuICAgIHB1YmxpYyB5OiBudW1iZXI7XHJcblxyXG4gICAgY29uc3RydWN0b3IoeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLnggPSB4O1xyXG4gICAgICAgIHRoaXMueSA9IHk7XHJcbiAgICB9XHJcbn1cclxuXHJcbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iXSwibmFtZXMiOlsiY29ubmVjdDQiLCJtZW51Iiwic2FtZVBDQnRuIiwiZXhpdEJ0biIsImNhbnZhcyIsIlRpbGUiLCJHYW1lTW9kZSIsImNhbnZhc0lkIiwiZXhpdEJ0bklkIiwidGltZXJJZCIsInBsYXllclJlZElkIiwicGxheWVyR3JlZW5JZCIsImJvYXJkIiwiQXJyYXkiLCJHYW1lIiwiY29sdW1ucyIsInR1cm4iLCJSRUQiLCJtb3ZlRG90IiwiZXZlbnQiLCJjbGVhclVwcGVyIiwicG9zaXRpb24iLCJnZXRDdXJzb3JQb3NpdGlvbiIsImNvbHVtbiIsIk1hdGgiLCJyb3VuZCIsIngiLCJjb250ZXh0IiwiZmlsbFN0eWxlIiwiR1JFRU4iLCJiZWdpblBhdGgiLCJhcmMiLCJQSSIsImNsb3NlUGF0aCIsImZpbGwiLCJsYW5kRG90Iiwicm93IiwiciIsInJvd3MiLCJjaGVja1RpbGVDb3VudCIsIndpbm5lciIsInBsYXllclJlZCIsInBsYXllckdyZWVuIiwiY2xhc3NMaXN0IiwiYWRkIiwid2luTXNnIiwidGltZXJTcGFuIiwiaW5uZXJUZXh0IiwiYWxlcnQiLCJsb2NhbFN0b3JhZ2UiLCJjbGVhciIsImNsZWFuVXBFdmVudHMiLCJzdG9wVGltZXIiLCJjbGVhclBsYXllck5hbWVzIiwidW5kZWZpbmVkIiwib25HYW1lRW5kIiwic2V0VGltZW91dCIsImJlZm9yZVVubG9hZCIsInNhdmVHYW1lIiwidGltZXJDYWxsYmFjayIsInNlY29uZHNSdW5uaW5nIiwibWludXRlcyIsImZsb29yIiwic2Vjb25kcyIsInRoaXMiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZ2V0Q29udGV4dCIsImNvbCIsIkVNUFRZIiwicGxheWVyUmVkU3BhbiIsInBsYXllckdyZWVuU3BhbiIsInN0YXJ0IiwiY2hlY2tHYW1lRGF0YSIsInNldFVwUGxheWVyTmFtZXMiLCJwYWludEJvYXJkIiwic2V0R2FtZUV2ZW50cyIsInNldFRpbWVyIiwibW9kZSIsIlNBTUVfUEMiLCJnZXRJdGVtIiwibmV4dFR1cm4iLCJjb25maXJtIiwicmVzdG9yZUxhc3RHYW1lIiwicHJvbXB0IiwiYm9hcmRHcmFkaWVudCIsImNyZWF0ZUxpbmVhckdyYWRpZW50Iiwid2lkdGgiLCJhZGRDb2xvclN0b3AiLCJmaWxsUmVjdCIsImhlaWdodCIsInkiLCJwYWdlWCIsInBhZ2VZIiwiY2xpZW50WCIsImJvZHkiLCJzY3JvbGxMZWZ0IiwiZG9jdW1lbnRFbGVtZW50IiwiY2xpZW50WSIsInNjcm9sbFRvcCIsIm9mZnNldExlZnQiLCJvZmZzZXRUb3AiLCJQb3NpdGlvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJ3aW5kb3ciLCJjbGVhclJlY3QiLCJjb3VudCIsImRvdENvdW50Iiwicm93Q291bnQiLCJjb2xDb3VudCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJzZXRJdGVtIiwidG9TdHJpbmciLCJKU09OIiwic3RyaW5naWZ5IiwicGFyc2VJbnQiLCJwYXJzZSIsImV4aXQiLCJ0aW1lckludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJyZW1vdmUiLCJjbGVhckludGVydmFsIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iXSwic291cmNlUm9vdCI6IiJ9