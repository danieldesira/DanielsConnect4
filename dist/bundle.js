(()=>{"use strict";var e,t,o,n,i,a,r,s,l,c={597:(e,t)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.Dot=void 0,(o=t.Dot||(t.Dot={})).EMPTY="black",o.RED="red",o.GREEN="greenyellow"},238:(e,t)=>{var o;Object.defineProperty(t,"__esModule",{value:!0}),t.GameMode=void 0,(o=t.GameMode||(t.GameMode={}))[o.SAME_PC=1]="SAME_PC",o[o.NETWORK=2]="NETWORK"},769:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Game=void 0;var n=o(238),i=o(597),a=o(969),r=function(){function e(t,o,a,r,s){void 0===o&&(o=null),void 0===a&&(a=null),void 0===r&&(r=null),void 0===s&&(s=null);var l=this;this.board=new Array(e.columns),this.turn=i.Dot.RED,this.moveDot=function(e){if(l.mode===n.GameMode.SAME_PC||l.turn===l.playerColor){l.clearUpper();var t=l.getCursorPosition(e),o=Math.round((t.x-50)/l.colGap);l.context.fillStyle=l.turn,l.paintDotToDrop(o)}},this.canvasClick=function(e){if(l.mode===n.GameMode.SAME_PC||l.turn===l.playerColor){var t=l.getCursorPosition(e),o=Math.round((t.x-50)/l.colGap);l.landDot(o)}},this.beforeUnload=function(e){l.mode===n.GameMode.SAME_PC?l.saveGame():l.mode===n.GameMode.NETWORK&&(e.preventDefault(),e.returnValue="")},this.timerCallback=function(){l.secondsRunning++;var e=Math.floor(l.secondsRunning/60),t=l.secondsRunning%60;l.timerSpan.innerText=e+":"+(t<10?"0":"")+t},this.pageVisibilityChange=function(){document.hidden?clearInterval(l.timerInterval):l.timerInterval=setInterval(l.timerCallback,1e3)},this.resizeCanvas=function(){l.canvas.height=window.innerHeight-100,l.canvas.width=window.innerWidth,l.canvas.width<1e3?l.circleRadius=20:l.circleRadius=30,l.canvas.height>l.canvas.width?(l.colGap=l.canvas.width/(e.columns+1),l.rowGap=l.canvas.height/(e.rows+1)):(l.colGap=l.canvas.width/(e.columns+1),l.rowGap=65),l.paintBoard()},this.socketMessage=function(e){var t=JSON.parse(e.data);if(!l.playerColor&&t.color){l.playerColor=t.color,l.setUpPlayerNames();var o={name:null};l.playerColor===i.Dot.RED?o.name=l.playerRed:l.playerColor===i.Dot.GREEN&&(o.name=l.playerGreen),l.socket.send(JSON.stringify(o))}t.opponentName&&(l.playerColor===i.Dot.RED?(l.playerGreen=t.opponentName,l.playerGreenSpan.innerText=l.playerGreen):l.playerColor===i.Dot.GREEN&&(l.playerRed=t.opponentName,l.playerRedSpan.innerText=l.playerRed)),!l.gameId&&t.gameId&&(l.gameId=t.gameId),t.message&&alert(t.message),t.win,t.column&&t.mousemove,t.column&&t.click&&l.landDot(t.column)},this.canvas=document.getElementById(t),this.context=this.canvas.getContext("2d");for(var c=0;c<e.columns;c++){this.board[c]=new Array(e.rows);for(var d=0;d<e.rows;d++)this.board[c][d]=i.Dot.EMPTY}null!==o&&(this.exitBtn=document.getElementById(o)),null!==a&&(this.timerSpan=document.getElementById(a),this.secondsRunning=0),null!==r&&(this.playerRedSpan=document.getElementById(r)),null!==s&&(this.playerGreenSpan=document.getElementById(s))}return e.prototype.start=function(){this.defineSocket(),this.checkGameData(),this.resizeCanvas(),this.setUpPlayerNames(),this.setGameEvents(),this.setTimer()},e.prototype.checkGameData=function(){if(this.mode===n.GameMode.SAME_PC){var e=localStorage.getItem("board"),t=localStorage.getItem("nextTurn");e&&t&&(confirm("Do you want to continue playing the previous game? OK/Cancel")?this.restoreLastGame():localStorage.clear())}},e.prototype.setUpPlayerNames=function(){if(this.mode===n.GameMode.SAME_PC)localStorage.getItem("playerRed")&&localStorage.getItem("playerGreen")||(this.playerRed=prompt("Please enter name for Red Player!"),this.playerGreen=prompt("Please enter name for Green Player!"));else if(this.mode===n.GameMode.NETWORK&&this.playerColor){var e=prompt("You are "+this.playerColor+". Please enter your name.");this.playerColor===i.Dot.RED?this.playerRed=e:this.playerColor===i.Dot.GREEN&&(this.playerGreen=e)}this.playerGreenSpan&&(this.playerGreenSpan.innerText=this.playerGreen),this.playerRedSpan&&(this.playerRedSpan.innerText=this.playerRed)},e.prototype.paintBoard=function(){var t=this.context.createLinearGradient(0,0,this.canvas.width,0);t.addColorStop(0,"blue"),t.addColorStop(1,"aqua"),this.context.fillStyle=t,this.context.fillRect(0,70,this.canvas.width,this.canvas.height);for(var o=e.columns-1;o>=0;o--)for(var n=e.rows-1;n>=0;n--)this.context.fillStyle=this.board[o][n],this.context.beginPath(),this.context.arc(50+o*this.colGap,150+n*this.rowGap,this.circleRadius,0,2*Math.PI),this.context.closePath(),this.context.fill()},e.prototype.getCursorPosition=function(e){var t,o;return void 0!==e.pageX||void 0!==e.pageY?(t=e.pageX,o=e.pageY):(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,o=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),t-=this.canvas.offsetLeft,o-=this.canvas.offsetTop,new a.Position(t,o)},e.prototype.setGameEvents=function(){this.canvas.addEventListener("mousemove",this.moveDot,!1),this.canvas.addEventListener("click",this.canvasClick,!1),window.addEventListener("beforeunload",this.beforeUnload),window.addEventListener("resize",this.resizeCanvas),document.addEventListener("visibilitychange",this.pageVisibilityChange)},e.prototype.landDot=function(t){var o;if(this.board[t][0]===i.Dot.EMPTY){for(var n=e.rows-1;n>-1;n--)if(this.board[t][n]===i.Dot.EMPTY){this.board[t][n]=this.turn,o=n;break}if(this.context.fillStyle=this.turn,this.context.beginPath(),this.context.arc(50+t*this.colGap,150+n*this.rowGap,this.circleRadius,0,2*Math.PI),this.context.closePath(),this.context.fill(),this.checkDotCount(t,o)>3){var a="";this.turn===i.Dot.RED?a=this.playerRed+" (Red)":this.turn===i.Dot.GREEN&&(a=this.playerGreen+" (Green)"),this.exitBtn&&this.exitBtn.classList.add("hide");var r=a+" wins!";this.timerSpan&&(r+="\nTime taken: "+this.timerSpan.innerText),alert(r),localStorage.clear(),this.cleanUpEvents(),this.stopTimer(),this.clearPlayerNames(),void 0!==this.onGameEnd&&null!==this.onGameEnd&&setTimeout(this.onGameEnd,3e3)}this.turn===i.Dot.RED?this.turn=i.Dot.GREEN:this.turn===i.Dot.GREEN&&(this.turn=i.Dot.RED),this.context.fillStyle=this.turn,this.paintDotToDrop(t)}},e.prototype.paintDotToDrop=function(e){this.context.beginPath(),this.context.arc(50+e*this.colGap,this.circleRadius,this.circleRadius,0,2*Math.PI),this.context.closePath(),this.context.fill()},e.prototype.clearUpper=function(){this.context.clearRect(0,0,this.canvas.width,70)},e.prototype.checkDotCount=function(t,o){for(var n=o,i=0;i<4&&n<e.rows&&this.board[t][n]===this.turn;)i++,n++;if(i<4){for(i=0,n=t;n<e.columns&&this.board[n][o]===this.turn;)i++,n++;for(n=t-1;n>-1&&this.board[n][o]===this.turn;)i++,n--;if(i<4){i=0;for(var a=o-1,r=t+1;i<4&&a>-1&&r<e.columns&&this.board[r][a]===this.turn;)i++,r++,a--;for(r=t,a=o;i<4&&a<e.rows&&r>-1&&this.board[r][a]===this.turn;)i++,r--,a++;if(i<4){for(i=0,a=o-1,r=t-1;i<4&&a>-1&&r>-1&&this.board[r][a]===this.turn;)i++,r--,a--;for(r=t,a=o;i<4&&a<e.rows&&r<e.columns&&this.board[r][a]===this.turn;)i++,r++,a++}}}return i},e.prototype.cleanUpEvents=function(){this.canvas.removeEventListener("mousemove",this.moveDot,!1),this.canvas.removeEventListener("click",this.canvasClick,!1),window.removeEventListener("beforeunload",this.beforeUnload),window.removeEventListener("resize",this.resizeCanvas),document.removeEventListener("changevisibility",this.pageVisibilityChange)},e.prototype.saveGame=function(){localStorage.setItem("nextTurn",this.turn.toString()),localStorage.setItem("board",JSON.stringify(this.board)),localStorage.setItem("playerRed",this.playerRed),localStorage.setItem("playerGreen",this.playerGreen),localStorage.setItem("secondsRunning",this.secondsRunning.toString())},e.prototype.restoreLastGame=function(){var e=localStorage.getItem("nextTurn");e===i.Dot.RED?this.turn=i.Dot.RED:e===i.Dot.GREEN&&(this.turn=i.Dot.GREEN),this.playerRed=localStorage.getItem("playerRed"),this.playerGreen=localStorage.getItem("playerGreen"),this.board=JSON.parse(localStorage.getItem("board")),this.secondsRunning=parseInt(localStorage.getItem("secondsRunning"))},e.prototype.exit=function(){this.cleanUpEvents(),this.mode===n.GameMode.SAME_PC&&this.saveGame(),this.onGameEnd(),this.stopTimer(),this.clearPlayerNames()},e.prototype.setTimer=function(){this.timerSpan&&(this.timerCallback(),this.timerInterval=setInterval(this.timerCallback,1e3),this.timerSpan.classList.remove("hide"))},e.prototype.stopTimer=function(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerSpan.classList.add("hide"))},e.prototype.clearPlayerNames=function(){this.playerGreenSpan&&(this.playerGreenSpan.innerText=""),this.playerRedSpan&&(this.playerRedSpan.innerText="")},e.prototype.defineSocket=function(){this.mode===n.GameMode.NETWORK&&(this.socket=new WebSocket("ws://localhost:443/"),this.socket.onmessage=this.socketMessage)},e.columns=9,e.rows=8,e}();t.Game=r},969:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Position=void 0;t.Position=function(e,t){this.x=e,this.y=t}}},d={};function h(e){var t=d[e];if(void 0!==t)return t.exports;var o=d[e]={exports:{}};return c[e](o,o.exports,h),o.exports}t=h(769),o=h(238),n=document.getElementById("menu"),i=document.getElementById("samePC"),a=document.getElementById("sockets"),r=document.getElementById("credits"),s=document.getElementById("exitBtn"),l=document.getElementById("board"),i.addEventListener("click",(function(){(e=new t.Game("board","exitBtn","timer","playerRed","playerGreen")).mode=o.GameMode.SAME_PC,e.onGameEnd=function(){n.classList.remove("hide"),l.classList.add("hide"),s.classList.add("hide")},e.start(),n.classList.add("hide"),l.classList.remove("hide"),s.classList.remove("hide")}),!1),a.addEventListener("click",(function(){(e=new t.Game("board","exitBtn","timer","playerRed","playerGreen")).mode=o.GameMode.NETWORK,e.onGameEnd=function(){n.classList.remove("hide"),l.classList.add("hide"),s.classList.add("hide")},e.start(),n.classList.add("hide"),l.classList.remove("hide"),s.classList.remove("hide")}),!1),r.addEventListener("click",(function(){open("contributors.html")}),!1),s.addEventListener("click",(function(){e.exit()}),!1)})();
//# sourceMappingURL=bundle.js.map